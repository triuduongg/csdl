{% extends "base.html" %}

{% block content %}
<h2>Tìm kiếm tài liệu</h2>

{% if query %}
    <p>Kết quả tìm kiếm cho: <strong>{{ query }}</strong></p>
{% else %}
    <p>Hiển thị tất cả tài liệu</p>
{% endif %}

<form method="get">
    <div class="input-group mb-3">
        <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="Nhập từ khóa tìm kiếm...">
        <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Tìm kiếm</button>
        </div>
    </div>
</form>

<a href="{% url 'documents:document_list' %}" class="btn btn-secondary">Quay lại danh sách tài liệu</a>

{% if documents %}
    <div class="mt-4">
        <h4>Kết quả ({{ documents|length }} tài liệu):</h4>
        <ul class="list-group">
            {% for document in documents %}
            <li class="list-group-item">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <h5 class="mb-1">{{ document.title }}</h5>
                        <p class="mb-1">{{ document.description|default:"Không có mô tả" }}</p>
                        <small class="text-muted">
                            Uploaded by: {{ document.uploaded_by.username }} on {{ document.upload_date|date:"d/m/Y H:i" }}
                        </small>
                    </div>
                    <div>
                        <a href="{% url 'documents:download_document' document.pk %}" class="btn btn-sm btn-success">Download</a>
                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
{% else %}
    <div class="alert alert-info mt-4">
        {% if query %}
            Không tìm thấy tài liệu nào với từ khóa: <strong>{{ query }}</strong>
        {% else %}
            Chưa có tài liệu nào trong hệ thống.
        {% endif %}
    </div>
{% endif %}

{% endblock %}
